library(ggplot2)
df = read.csv('/Users/clarenceyeung/Desktop/20260106_HA-466_processed.csv', check.names=FALSE
df = read.csv('/Users/clarenceyeung/Desktop/20260106_HA-466_processed.csv', check.names=FALSE)
df = read.csv('/Users/clarenceyeung/Desktop/20260106_HA-466_processed.csv', check.names=FALSE)
View(df)
melted = melt(df, by=c('Antibody/Payload','Concentration'))
library(reshape2)
melted = melt(df, by=c('Antibody/Payload','Concentration'))
View(melted)
df = read.csv('/Users/clarenceyeung/Desktop/20260106_HA-466_processed.csv', check.names=FALSE)
melted = melt(df, by=c('Antibody/Payload','Concentration','Time point (hr)'))
View(melted)
df = read.csv('/Users/clarenceyeung/Desktop/20260106_HA-466_processed.csv', check.names=FALSE)
melted = melt(df, by=c('Antibody/Payload','Concentration','Time point (hr)'))
View(melted)
View(df)
df = read.csv('/Users/clarenceyeung/Desktop/20260106_HA-466_processed.csv', check.names=FALSE)
melted = melt(df, by=c('Antibody/Payload','Concentration','Time point (hr)'))
View(melted)
melted = melt(df, id=c('Antibody/Payload','Concentration','Time point (hr)'))
View(melted)
ggplot(melted,aes(x=Concentration,y=value))+
facet_wrap(~variable)+
geom_dotplot()
melted$value=as.numeric(melted$value)
ggplot(melted,aes(x=Concentration,y=value))+
facet_wrap(~variable)+
geom_dotplot()
ggplot(melted,aes(x=Concentration,y=value))+
facet_wrap(~variable)+
geom_point()
ggplot(melted,aes(x=Concentration,y=value))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()
ggplot(melted,aes(x=Concentration,y=value))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()
ggplot(melted,aes(x=Concentration,y=value, color=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()
ggplot(melted,aes(x=Concentration,y=value, fill=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()
melted$`Time point (hr)`=as.character(melted$`Time point (hr)`)
ggplot(melted,aes(x=Concentration,y=value, fill=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()
ggplot(melted,aes(x=Concentration,y=value, color=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()
melted %>%
dplyr:filter(`Antibody/Payload`=='HA-466-b4')%>%
ggplot(aes(x=Concentration,y=value, color=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()
library(tidyr)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(reshape2)
melted %>%
dplyr:filter(`Antibody/Payload`=='HA-466-b4')%>%
ggplot(aes(x=Concentration,y=value, color=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()
melted %>%
dplyr::filter(`Antibody/Payload`=='HA-466-b4')%>%
ggplot(aes(x=Concentration,y=value, color=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()
melted %>%
dplyr::filter(`Antibody/Payload`=='HA-466-b4')%>%
ggplot(aes(x=Concentration,y=value, color=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()+
theme_minimal()
melted %>%
dplyr::filter(`Antibody/Payload`=='HA-466-b4')%>%
ggplot(aes(x=Concentration,y=value, color=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()+
theme_minimal()+
ylab('% of population')
melted %>%
dplyr::filter(`Antibody/Payload`=='HA-466-b4')%>%
ggplot(aes(x=Concentration,y=value, color=`Time point (hr)`))+
facet_wrap(`Antibody/Payload`~variable)+
geom_point()+
scale_x_log10()+
theme_minimal()+
ylab('% of population')+
geom_smooth()
head(melted %>%
dplyr::filter(`Antibody/Payload`=='HA-466-b4'))
df <- melted %>%
filter(`Antibody/Payload` == "HA-466-b4") %>%
drop_na(value)
fits <- df %>%
group_by(variable, `Time point (hr)`) %>%
nest() %>%
mutate(
model = map(data, ~ drm(
value ~ Concentration,
data = .x,
fct = LL.4(names = c("Slope", "Lower", "Upper", "IC50"))
)),
ic50 = map_dbl(model, ~ ED(.x, 50, type = "absolute")[1])
)
pred <- fits %>%
mutate(
pred = map2(
model, data,
~ {
newdata <- tibble(
Concentration = exp(seq(
log(min(.y$Concentration)),
log(max(.y$Concentration)),
length.out = 100
))
)
newdata$value <- predict(.x, newdata)
newdata
}
)
) %>%
unnest(pred)
ic50_labels <- fits %>%
left_join(df, by = c("variable", "Time point (hr)")) %>%
group_by(variable, `Time point (hr)`, ic50) %>%
summarise(
x = max(Concentration),
y = max(value),
.groups = "drop"
) %>%
mutate(
label = paste0("IC50 = ", signif(ic50, 3))
)
ggplot(df, aes(
x = Concentration,
y = value,
color = `Time point (hr)`
)) +
facet_wrap(`Antibody/Payload` ~ variable, scales = "free_y") +
geom_point(size = 2, alpha = 0.8) +
geom_line(
data = pred,
aes(group = `Time point (hr)`),
linewidth = 0.8
) +
geom_text(
data = ic50_labels,
aes(x = x, y = y, label = label),
hjust = 1.05, vjust = 1.2,
size = 3,
show.legend = FALSE
) +
scale_x_log10() +
theme_minimal() +
ylab("% of population") +
labs(x = "Concentration")
fits <- df %>%
group_by(variable, `Time point (hr)`) %>%
nest() %>%
mutate(
model = map(data, ~ drm(
value ~ Concentration,
data = .x,
fct = LL.4(names = c("Slope", "Lower", "Upper", "IC50"))
)),
ic50 = map_dbl(model, ~ ED(.x, 50, type = "absolute")[1])
)
library(drc)
fits <- df %>%
group_by(variable, `Time point (hr)`) %>%
nest() %>%
mutate(
model = map(data, ~ drm(
value ~ Concentration,
data = .x,
fct = LL.4(names = c("Slope", "Lower", "Upper", "IC50"))
)),
ic50 = map_dbl(model, ~ ED(.x, 50, type = "absolute")[1])
)
pred <- fits %>%
mutate(
pred = map2(
model, data,
~ {
newdata <- tibble(
Concentration = exp(seq(
log(min(.y$Concentration)),
log(max(.y$Concentration)),
length.out = 100
))
)
newdata$value <- predict(.x, newdata)
newdata
}
)
) %>%
unnest(pred)
ic50_labels <- fits %>%
left_join(df, by = c("variable", "Time point (hr)")) %>%
group_by(variable, `Time point (hr)`, ic50) %>%
summarise(
x = max(Concentration),
y = max(value),
.groups = "drop"
) %>%
mutate(
label = paste0("IC50 = ", signif(ic50, 3))
)
ggplot(df, aes(
x = Concentration,
y = value,
color = `Time point (hr)`
)) +
facet_wrap(`Antibody/Payload` ~ variable, scales = "free_y") +
geom_point(size = 2, alpha = 0.8) +
geom_line(
data = pred,
aes(group = `Time point (hr)`),
linewidth = 0.8
) +
geom_text(
data = ic50_labels,
aes(x = x, y = y, label = label),
hjust = 1.05, vjust = 1.2,
size = 3,
show.legend = FALSE
) +
scale_x_log10() +
theme_minimal() +
ylab("% of population") +
labs(x = "Concentration")
